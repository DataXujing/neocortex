!function(r){function a(e){if(t[e])return t[e].exports;var s=t[e]={exports:{},id:e,loaded:!1};return r[e].call(s.exports,s,s.exports,a),s.loaded=!0,s.exports}var t={};return a.m=r,a.c=t,a.p="",a(0)}([function(r,a,t){"use strict";function e(r){if(r&&r.__esModule)return r;var a={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(a[t]=r[t]);return a.default=r,a}Object.defineProperty(a,"__esModule",{value:!0});var s=t(3),n=e(s),i=t(5),o=t(6),u=t(7),h=t(8),l=t(9),f=t(10);a.activationFuncs=n,a.denseLayer=i.denseLayer,a.embeddingLayer=o.embeddingLayer,a.batchNormalizationLayer=u.batchNormalizationLayer,a.rGRULayer=h.rGRULayer,a.MatmulWebGL=l.MatmulWebGL,a.NeuralNet=f.NeuralNet},function(r,a,t){"use strict";function e(r){if(!r)return o;for(var a=0;a<r.args.length;++a){var t=r.args[a];0===a?r.args[a]={name:t,lvalue:!0,rvalue:!!r.rvalue,count:r.count||1}:r.args[a]={name:t,lvalue:!1,rvalue:!0,count:1}}return r.thisVars||(r.thisVars=[]),r.localVars||(r.localVars=[]),r}function s(r){return i({args:r.args,pre:e(r.pre),body:e(r.body),post:e(r.proc),funcName:r.funcName})}function n(r){for(var a=[],t=0;t<r.args.length;++t)a.push("a"+t);var e=new Function("P",["return function ",r.funcName,"_ndarrayops(",a.join(","),") {P(",a.join(","),");return a0}"].join(""));return e(s(r))}var i=t(11),o={body:"",args:[],thisVars:[],localVars:[]},u={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var r in u){var t=u[r];a[r]=n({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:r}),a[r+"eq"]=n({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:!0,funcName:r+"eq"}),a[r+"s"]=n({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:r+"s"}),a[r+"seq"]=n({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:!0,funcName:r+"seq"})}}();var h={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var r in h){var t=h[r];a[r]=n({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:r}),a[r+"eq"]=n({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:!0,count:2,funcName:r+"eq"})}}();var l={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var r in l){var t=l[r];a[r]=n({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:r}),a[r+"s"]=n({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:r+"s"}),a[r+"eq"]=n({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:!0,count:2,funcName:r+"eq"}),a[r+"seq"]=n({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:!0,count:2,funcName:r+"seq"})}}();var f=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var r=0;r<f.length;++r){var t=f[r];a[t]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t}),a[t+"eq"]=n({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"})}}();var c=["max","min","atan2","pow"];!function(){for(var r=0;r<c.length;++r){var t=c[r];a[t]=n({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t}),a[t+"s"]=n({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"}),a[t+"eq"]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"}),a[t+"seq"]=n({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"seq"})}}();var d=["atan2","pow"];!function(){for(var r=0;r<d.length;++r){var t=d[r];a[t+"op"]=n({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"}),a[t+"ops"]=n({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"}),a[t+"opeq"]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opeq"}),a[t+"opseq"]=n({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opseq"})}}(),a.any=i({args:["array"],pre:o,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),a.all=i({args:["array"],pre:o,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),a.sum=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),a.prod=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),a.norm2squared=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),a.norm2=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),a.norminf=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),a.norm1=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),a.sup=i({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),a.inf=i({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),a.argmin=i({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),a.argmax=i({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),a.random=n({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),a.assign=n({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),a.assigns=n({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),a.equals=i({args:["array","array"],pre:o,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},function(r,a,t){function e(r,a){return r[0]-a[0]}function s(){var r,a=this.stride,t=new Array(a.length);for(r=0;r<t.length;++r)t[r]=[Math.abs(a[r]),r];t.sort(e);var s=new Array(t.length);for(r=0;r<s.length;++r)s[r]=t[r][1];return s}function n(r,a){var t=["View",a,"d",r].join("");0>a&&(t="View_Nil"+r);var e="generic"===r;if(-1===a){var n="function "+t+"(a){this.data=a;};	var proto="+t+".prototype;	proto.dtype='"+r+"';	proto.index=function(){return -1};	proto.size=0;	proto.dimension=-1;	proto.shape=proto.stride=proto.order=[];	proto.lo=proto.hi=proto.transpose=proto.step=	function(){return new "+t+"(this.data);};	proto.get=proto.set=function(){};	proto.pick=function(){return null};	return function construct_"+t+"(a){return new "+t+"(a);}",i=new Function(n);return i()}if(0===a){var n="function "+t+"(a,d) {	this.data = a;	this.offset = d	};	var proto="+t+".prototype;	proto.dtype='"+r+"';	proto.index=function(){return this.offset};	proto.dimension=0;	proto.size=1;	proto.shape=	proto.stride=	proto.order=[];	proto.lo=	proto.hi=	proto.transpose=	proto.step=function "+t+"_copy() {	return new "+t+"(this.data,this.offset)	};	proto.pick=function "+t+"_pick(){	return TrivialArray(this.data);	};	proto.valueOf=proto.get=function "+t+"_get(){	return "+(e?"this.data.get(this.offset)":"this.data[this.offset]")+"};	proto.set=function "+t+"_set(v){	return "+(e?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"	};	return function construct_"+t+"(a,b,c,d){return new "+t+"(a,d)}",i=new Function("TrivialArray",n);return i(f[r][0])}var n=["'use strict'"],o=u(a),h=o.map(function(r){return"i"+r}),l="this.offset+"+o.map(function(r){return"this.stride["+r+"]*i"+r}).join("+"),c=o.map(function(r){return"b"+r}).join(","),d=o.map(function(r){return"c"+r}).join(",");n.push("function "+t+"(a,"+c+","+d+",d){this.data=a","this.shape=["+c+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+t+".prototype","proto.dtype='"+r+"'","proto.dimension="+a),n.push("Object.defineProperty(proto,'size',{get:function "+t+"_size(){	return "+o.map(function(r){return"this.shape["+r+"]"}).join("*"),"}})"),1===a?n.push("proto.order=[0]"):(n.push("Object.defineProperty(proto,'order',{get:"),4>a?(n.push("function "+t+"_order(){"),2===a?n.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===a&&n.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);	if(s0>s1){	if(s1>s2){	return [2,1,0];	}else if(s0>s2){	return [1,2,0];	}else{	return [1,0,2];	}	}else if(s0>s2){	return [2,0,1];	}else if(s2>s1){	return [0,1,2];	}else{	return [0,2,1];	}}})")):n.push("ORDER})")),n.push("proto.set=function "+t+"_set("+h.join(",")+",v){"),e?n.push("return this.data.set("+l+",v)}"):n.push("return this.data["+l+"]=v}"),n.push("proto.get=function "+t+"_get("+h.join(",")+"){"),e?n.push("return this.data.get("+l+")}"):n.push("return this.data["+l+"]}"),n.push("proto.index=function "+t+"_index(",h.join(),"){return "+l+"}"),n.push("proto.hi=function "+t+"_hi("+h.join(",")+"){return new "+t+"(this.data,"+o.map(function(r){return["(typeof i",r,"!=='number'||i",r,"<0)?this.shape[",r,"]:i",r,"|0"].join("")}).join(",")+","+o.map(function(r){return"this.stride["+r+"]"}).join(",")+",this.offset)}");var p=o.map(function(r){return"a"+r+"=this.shape["+r+"]"}),_=o.map(function(r){return"c"+r+"=this.stride["+r+"]"});n.push("proto.lo=function "+t+"_lo("+h.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+_.join(","));for(var g=0;a>g;++g)n.push("if(typeof i"+g+"==='number'&&i"+g+">=0){	d=i"+g+"|0;	b+=c"+g+"*d;	a"+g+"-=d}");n.push("return new "+t+"(this.data,"+o.map(function(r){return"a"+r}).join(",")+","+o.map(function(r){return"c"+r}).join(",")+",b)}"),n.push("proto.step=function "+t+"_step("+h.join(",")+"){var "+o.map(function(r){return"a"+r+"=this.shape["+r+"]"}).join(",")+","+o.map(function(r){return"b"+r+"=this.stride["+r+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var g=0;a>g;++g)n.push("if(typeof i"+g+"==='number'){	d=i"+g+"|0;	if(d<0){	c+=b"+g+"*(a"+g+"-1);	a"+g+"=ceil(-a"+g+"/d)	}else{	a"+g+"=ceil(a"+g+"/d)	}	b"+g+"*=d	}");n.push("return new "+t+"(this.data,"+o.map(function(r){return"a"+r}).join(",")+","+o.map(function(r){return"b"+r}).join(",")+",c)}");for(var y=new Array(a),m=new Array(a),g=0;a>g;++g)y[g]="a[i"+g+"]",m[g]="b[i"+g+"]";n.push("proto.transpose=function "+t+"_transpose("+h+"){"+h.map(function(r,a){return r+"=("+r+"===undefined?"+a+":"+r+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+t+"(this.data,"+y.join(",")+","+m.join(",")+",this.offset)}"),n.push("proto.pick=function "+t+"_pick("+h+"){var a=[],b=[],c=this.offset");for(var g=0;a>g;++g)n.push("if(typeof i"+g+"==='number'&&i"+g+">=0){c=(c+this.stride["+g+"]*i"+g+")|0}else{a.push(this.shape["+g+"]);b.push(this.stride["+g+"])}");n.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),n.push("return function construct_"+t+"(data,shape,stride,offset){return new "+t+"(data,"+o.map(function(r){return"shape["+r+"]"}).join(",")+","+o.map(function(r){return"stride["+r+"]"}).join(",")+",offset)}");var i=new Function("CTOR_LIST","ORDER",n.join("\n"));return i(f[r],s)}function i(r){if(h(r))return"buffer";if(l)switch(Object.prototype.toString.call(r)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(r)?"array":"generic"}function o(r,a,t,e){if(void 0===r){var s=f.array[0];return s([])}"number"==typeof r&&(r=[r]),void 0===a&&(a=[r.length]);var o=a.length;if(void 0===t){t=new Array(o);for(var u=o-1,h=1;u>=0;--u)t[u]=h,h*=a[u]}if(void 0===e){e=0;for(var u=0;o>u;++u)t[u]<0&&(e-=(a[u]-1)*t[u])}for(var l=i(r),c=f[l];c.length<=o+1;)c.push(n(l,c.length-1));var s=c[o+1];return s(r,a,t,e)}var u=t(15),h=t(16),l="undefined"!=typeof Float64Array,f={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};r.exports=o},function(r,a,t){"use strict";function e(r){return r&&r.__esModule?r:{"default":r}}function s(r){return r}function n(r){return f.default.divseq(f.default.addeq(r,f.default.abseq(r)),2),r}function i(r){return f.default.recipeq(f.default.addseq(f.default.expeq(f.default.negeq(r)),1)),r}function o(r){f.default.addseq(f.default.mulseq(r,.2),.5);for(var a=0;a<r.size;a++)r.data[a]>1&&(r.data[a]=1),r.data[a]<0&&(r.data[a]=0);return r}function u(r){f.default.expeq(f.default.mulseq(r,2));for(var a=0;a<r.size;a++)r.data[a]=(r.data[a]-1)/(r.data[a]+1);return r}function h(r){f.default.expeq(r);var a=f.default.sum(r);return f.default.divseq(r,a),r}Object.defineProperty(a,"__esModule",{value:!0}),a.linear=s,a.relu=n,a.sigmoid=i,a.sigmoidHard=o,a.tanh=u,a.softmax=h;var l=t(1),f=e(l)},function(r,a){"use strict";function t(r,a,t){return"generic"===r?[a,".get(",t,")"].join(""):[a,"[",t,"]"].join("")}function e(r,a,t,e){return"generic"===r?[a,".set(",t,",",e,")"].join(""):[a,"[",t,"]=",e].join("")}function s(r,a){var s=["matrixVectorProd",r?"RowMajor":"ColumnMajor",a.join("t")].join(""),n=["function ",s,"(o,m,v){	var o_d=o.data,o_i=o.offset,o_s=o.stride[0],	m_d=m.data,m_i=m.offset,m_s0=m.stride[0],m_s1=m.stride[1],	v_d=v.data,v_i=v.offset,v_s=v.stride[0],r=m.shape[0],c=m.shape[1],"];r?n.push("s1=m_s0-m_s1*r;for(var j=0;j<c;++j){	var v_p=v_i,x=0;	for(var i=0;i<r;++i){	x+=",t(a[1],"m_d","m_i"),"*",t(a[2],"v_d","v_p"),";	v_p+=v_s;	m_i+=m_s1;	}",e(a[0],"o_d","o_i","x"),";	o_i+=o_s;	m_i+=s1;	}"):(n.push("o_p=o_i;for(var i=0;i<r;++i){",e(a[0],"o_d","o_p","0"),";	o_p+=o_s}	var s0=m_s1-m_s0*c;for(var j=0;j<r;++j){	o_p=o_i;","var x=",t(a[2],"v_d","v_i"),";	for(var i=0;i<c;++i){"),"generic"===a[0]?n.push("o_d.set(o_p,o_d.get(o_p)+x*",t(a[1],"m_d","m_i"),";"):n.push("o_d[o_p]+=",t(a[1],"m_d","m_i"),"*x;"),n.push("m_i+=m_s0;	o_p+=o_s;	}	m_i+=s0;	v_i+=v_s;	}")),n.push("}return ",s,";");var i=new Function(n.join(""));return i()}function n(r,a,t){var e;e=a.stride[0]>a.stride[1]?i:o;var n=e[r.dtype];n||(e[r.dtype]=n={});var u=n[a.dtype];u||(n[a.dtype]=u={});var h=u[t.dtype];h||(u[t.dtype]=h=s(a.stride[0]>a.stride[1],[r.dtype,a.dtype,t.dtype])),h(r,a,t)}r.exports=n;var i={},o={}},function(r,a,t){"use strict";function e(r){if(r&&r.__esModule)return r;var a={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(a[t]=r[t]);return a.default=r,a}function s(r){return r&&r.__esModule?r:{"default":r}}function n(r,a){var t=arguments.length<=2||void 0===arguments[2]?"linear":arguments[2],e=a.W,s=a.b,n=o.default(new Float64Array(e.shape[0]),[e.shape[0]]);return f.default(n,e,r),h.default.addeq(n,s),d[t](n),n}Object.defineProperty(a,"__esModule",{value:!0}),a.denseLayer=n;var i=t(2),o=s(i),u=t(1),h=s(u),l=t(4),f=s(l),c=t(3),d=e(c)},function(r,a,t){"use strict";function e(r){return r&&r.__esModule?r:{"default":r}}function s(r,a){for(var t=a.E,e=r.data.reduce(function(r,a){return r+(a>0?1:0)},0),s=i.default(new Float64Array(e*t.shape[1]),[e,t.shape[1]]),n=0,o=0;o<r.shape[0];o++)r.get(o)>0&&(u.default.assign(s.pick(n,null),t.pick(r.get(o),null)),n+=1);return s}Object.defineProperty(a,"__esModule",{value:!0}),a.embeddingLayer=s;var n=t(2),i=e(n),o=t(1),u=e(o)},function(r,a,t){"use strict";function e(r){return r&&r.__esModule?r:{"default":r}}function s(r,a){var t=a.gamma,e=a.beta,s=a.mean,n=a.std;return o.default.addeq(o.default.muleq(o.default.diveq(o.default.subeq(r,s),o.default.addseq(n,u)),t),e),r}Object.defineProperty(a,"__esModule",{value:!0}),a.batchNormalization=s;var n=t(2),i=(e(n),t(1)),o=e(i),u=1e-6},function(r,a,t){"use strict";function e(r){if(r&&r.__esModule)return r;var a={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(a[t]=r[t]);return a.default=r,a}function s(r){return r&&r.__esModule?r:{"default":r}}function n(r,a){function t(){h.default.assign(R,E),f.default(w,n.transpose(1,0),m),f.default(L,i.transpose(1,0),R),h.default.assigns(A,0),h.default.addeq(A,w),h.default.addeq(A,L),h.default.addeq(A,u),d[s](A),f.default(x,l.transpose(1,0),m),f.default(G,c.transpose(1,0),R),h.default.assigns(j,0),h.default.addeq(j,x),h.default.addeq(j,G),h.default.addeq(j,p),d[s](j),f.default(V,_.transpose(1,0),m),h.default.mul(v,j,R),f.default(T,g.transpose(1,0),v),h.default.assigns(E,0),h.default.addeq(E,V),h.default.addeq(E,T),h.default.addeq(E,y),d[e](E),h.default.mul(v,A,R),h.default.assign(b,A),h.default.addseq(h.default.negeq(b),1),h.default.muleq(b,E),h.default.addeq(b,v),h.default.assign(E,b)}var e=arguments.length<=2||void 0===arguments[2]?"tanh":arguments[2],s=arguments.length<=3||void 0===arguments[3]?"sigmoidHard":arguments[3],n=a.W_xz,i=a.W_hz,u=a.b_z,l=a.W_xr,c=a.W_hr,p=a.b_r,_=a.W_xh,g=a.W_hh,y=a.b_h,m=o.default(new Float64Array(r.shape[1]),[r.shape[1]]),v=o.default(new Float64Array(r.shape[1]),[r.shape[1]]),b=o.default(new Float64Array(r.shape[1]),[r.shape[1]]),A=o.default(new Float64Array(r.shape[1]),[r.shape[1]]),w=o.default(new Float64Array(r.shape[1]),[r.shape[1]]),L=o.default(new Float64Array(r.shape[1]),[r.shape[1]]),j=o.default(new Float64Array(r.shape[1]),[r.shape[1]]),x=o.default(new Float64Array(r.shape[1]),[r.shape[1]]),G=o.default(new Float64Array(r.shape[1]),[r.shape[1]]),E=o.default(new Float64Array(r.shape[1]),[r.shape[1]]),V=o.default(new Float64Array(r.shape[1]),[r.shape[1]]),T=o.default(new Float64Array(r.shape[1]),[r.shape[1]]),R=o.default(new Float64Array(r.shape[1]),[r.shape[1]]);h.default.assigns(E,0);for(var k=0;k<r.shape[0];k++)h.default.assign(m,r.pick(k,null)),t();return E}Object.defineProperty(a,"__esModule",{value:!0}),a.rGRULayer=n;var i=t(2),o=s(i),u=t(1),h=s(u),l=t(4),f=s(l),c=t(3),d=e(c)},function(r,a,t){"use strict";function e(r){return r&&r.__esModule?r:{"default":r}}function s(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var n=function(){function r(r,a){for(var t=0;t<a.length;t++){var e=a[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}return function(a,t,e){return t&&r(a.prototype,t),e&&r(a,e),a}}(),i=t(2),o=(e(i),function(){function r(a){s(this,r),a=a||{},this.matA=null,this.matB=null,this.canvas=null,this.GL=null,this.renderer=null,this.texture=null,this.destTexture=null,this.renderbuffer=null,this.framebuffer=null,this.vertexShaderCode="\n	// works on texels passed to texture shader \n	#ifdef GL_ES \n		precision highp float; \n	#endif \n	\n	attribute vec3 aPos; \n	attribute vec2 aTex; \n	varying vec2   vTex; \n	void main(void) \n	{ \n		gl_Position = vec4(aPos, 1.0); \n		vTex = aTex; \n	}",this.fragmentShaderCode="\n	// Fragment shader performs calculations based on the passed row and column as texture coordinates. \n	// Result rendered as 32-bit IEEE754 floating point to the RGBA canvas, readPixel is then used to read out the bytes. \n	#ifdef GL_ES \n		precision highp float; \n	#endif \n	\n	varying vec2	  vTex;         // row, column to calculate \n	uniform sampler2D usampler;		// left in .r, right in .g \n	uniform int		  uLength;      // r1xc1.r2xc2 => product has r2 (or c1) terms \n	uniform float	  uStepS;       // increment across source texture \n	uniform float	  uStepT;       // increment down source texture \n	uniform float	  uOutRows;     // size of output in rows \n	uniform float	  uOutCols;     // size of output in columns \n	\n	// sum row r x col c \n	float sumrowcol(float row, float col) { \n		float sum = 0.; \n		float ss = 0.;                // column on source texture \n		float tt = 0.;                // row on source texture \n		float r = row * uStepT;       // moving texture coordinate \n		float c = col * uStepS;       // moving texture coordinate \n		for (int pos = 0; pos < 2048; ++pos) { \n			if (pos >= uLength) break; // stop when we multiple a row by a column \n			float m1 = texture2D(usampler, vec2(ss, r)).r; \n			float m2 = texture2D(usampler, vec2(c, tt)).g; \n			sum += (m1 * m2); \n			ss += uStepS; \n			tt += uStepT; \n		} \n		return sum; \n	} \n	\n	void main(void) { \n	\n		// get the implied row and column from .s and .t of passed texel \n		float col = floor((vTex.s*uOutRows)); \n		float row = floor((vTex.t*uOutCols));    \n	\n		// sum row x col for the passed pixel \n		float v = sumrowcol(row,col); \n	\n		// Render to IEEE754 Floating Point \n		if (v==0.) { \n			gl_FragColor = vec4(0.,0.,0.,0.); \n			return; \n		} \n		float a = abs(v); \n		float exp = floor(log2(a)); \n		float mantissa = (a * pow(2., 23. - exp)); // fill 24 bits \n		float mantissa_0_7 = floor(mantissa / 256. / 256.); \n		float mantissa_8_15 = mod(floor(mantissa / 256.),256.); \n		float mantissa_16_23 = mod(mantissa,256.); \n	\n		highp float sign = 128. - 128. * (a / v); \n		highp float e = (sign + exp + 127.) / 510.;\n		highp float m1 = (mantissa_0_7 - (128. * (1. - mod(exp + 127., 2.)))) / 255.; \n		highp float m2 = (mantissa_8_15) / 255.; \n		highp float m3 = (mantissa_16_23 + .5) / 255.; \n		gl_FragColor = vec4(m3, m2, m1, e); \n	}"}return n(r,[{key:"init",value:function(r,a){if(this.matA=r,this.matB=a,this.canvas=document.getElementById("matmulWebGL"),this.canvas.height=r.shape[0],this.canvas.width=a.shape[1],!this.GL){var t={premultipliedAlpha:!1,preserveDrawingBuffer:!1};if(this.GL=this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t),"undefined"==typeof this.GL||null===this.GL)throw new Error("webGL not supported.")}this.GL.viewport(0,0,a.shape[1],r.shape[0]);var e=this.GL.createShader(this.GL.VERTEX_SHADER);this.GL.shaderSource(e,this.vertexShaderCode),this.GL.compileShader(e);var s=this.GL.createShader(this.GL.FRAGMENT_SHADER);this.GL.shaderSource(s,this.fragmentShaderCode),this.GL.compileShader(s),this.renderer=this.GL.createProgram(),this.GL.attachShader(this.renderer,e),this.GL.attachShader(this.renderer,s),this.GL.linkProgram(this.renderer),this.GL.useProgram(this.renderer),this._bindTexture(),this._bindUniform(),this._bindVertices(),this._bindFrameBuffer()}},{key:"_bindTexture",value:function(){var r=this.matA.shape[0],a=this.matA.shape[1],t=this.matB.shape[0],e=this.matB.shape[1],s=Math.max(r,t),n=Math.max(a,e),i=new Float32Array(3*s*n),o=s*n;if(r===t&&a===e){var u=0,h=0,l=0;do i[u++]=this.matA.data[h++],i[u++]=this.matB.data[l++],u++;while(--o)}else{var f=0,c=0;do i[3*(f*a+c)]=this.matA.data[srcA++],i[3*(c*t+f)+1]=this.matB[c*t+f],c>=a&&(c=0,f++);while(--o)}this.texture=this.GL.createTexture(),this.GL.activeTexture(this.GL.TEXTURE0),this.GL.bindTexture(this.GL.TEXTURE_2D,this.texture),this.GL.texImage2D(this.GL.TEXTURE_2D,0,this.GL.RGB,Math.max(a,e),Math.max(r,t),0,this.GL.RGB,this.GL.FLOAT,i),this.GL.texParameteri(this.GL.TEXTURE_2D,this.GL.TEXTURE_WRAP_S,this.GL.CLAMP_TO_EDGE),this.GL.texParameteri(this.GL.TEXTURE_2D,this.GL.TEXTURE_WRAP_T,this.GL.CLAMP_TO_EDGE),this.GL.texParameteri(this.GL.TEXTURE_2D,this.GL.TEXTURE_MAG_FILTER,this.GL.NEAREST),this.GL.texParameteri(this.GL.TEXTURE_2D,this.GL.TEXTURE_MIN_FILTER,this.GL.NEAREST),this.GL.uniform1i(this.GL.getUniformLocation(this.renderer,"usampler"),0),this.destTexture=this.GL.createTexture(),this.GL.activeTexture(this.GL.TEXTURE2),this.GL.bindTexture(this.GL.TEXTURE_2D,this.destTexture),this.GL.texImage2D(this.GL.TEXTURE_2D,0,this.GL.RGBA,this.GL.RGBA,this.GL.UNSIGNED_BYTE,this.canvas)}},{key:"_bindUniform",value:function(){var r=this.GL.getUniformLocation(this.renderer,"uLength"),a=this.GL.getUniformLocation(this.renderer,"uOutRows"),t=this.GL.getUniformLocation(this.renderer,"uOutCols"),e=this.GL.getUniformLocation(this.renderer,"uStepS"),s=this.GL.getUniformLocation(this.renderer,"uStepT");this.GL.uniform1i(r,this.matA.shape[1]),this.GL.uniform1f(a,this.matA.shape[0]),this.GL.uniform1f(t,this.matB.shape[1]),this.GL.uniform1f(e,1/Math.max(this.matA.shape[1],this.matB.shape[1])),this.GL.uniform1f(s,1/Math.max(this.matA.shape[0],this.matB.shape[0]))}},{key:"_bindVertices",value:function(){var r=this.GL.getAttribLocation(this.renderer,"aPos"),a=this.GL.createBuffer();this.GL.bindBuffer(this.GL.ARRAY_BUFFER,a);var t=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];this.GL.bufferData(this.GL.ARRAY_BUFFER,new Float32Array(t),this.GL.STATIC_DRAW),this.GL.vertexAttribPointer(r,3,this.GL.FLOAT,!1,0,0),this.GL.enableVertexAttribArray(r);var e=this.GL.getAttribLocation(this.renderer,"aTex"),s=this.GL.createBuffer();this.GL.bindBuffer(this.GL.ARRAY_BUFFER,s);var n=[0,0,1,0,1,1,0,1];this.GL.bufferData(this.GL.ARRAY_BUFFER,new Float32Array(n),this.GL.STATIC_DRAW),this.GL.vertexAttribPointer(e,2,this.GL.FLOAT,!1,0,0),this.GL.enableVertexAttribArray(e);var i=this.GL.createBuffer();this.GL.bindBuffer(this.GL.ELEMENT_ARRAY_BUFFER,i);var o=[0,1,2,0,2,3];this.GL.bufferData(this.GL.ELEMENT_ARRAY_BUFFER,new Uint16Array(o),this.GL.STATIC_DRAW)}},{key:"_bindFrameBuffer",value:function(){this.renderbuffer=this.renderbuffer||this.GL.createRenderbuffer(),this.GL.bindRenderbuffer(this.GL.RENDERBUFFER,null),this.GL.bindRenderbuffer(this.GL.RENDERBUFFER,this.renderbuffer),this.GL.renderbufferStorage(this.GL.RENDERBUFFER,this.GL.DEPTH_COMPONENT16,this.matB.shape[1],this.matA.shape[0]),this.framebuffer=this.framebuffer||this.GL.createFramebuffer(),this.GL.bindFramebuffer(this.GL.FRAMEBUFFER,this.framebuffer),this.GL.framebufferTexture2D(this.GL.FRAMEBUFFER,this.GL.COLOR_ATTACHMENT0,this.GL.TEXTURE_2D,this.destTexture,0),this.GL.framebufferRenderbuffer(this.GL.FRAMEBUFFER,this.GL.DEPTH_ATTACHMENT,this.GL.RENDERBUFFER,this.renderbuffer)}},{key:"multiply",value:function(){var r=new ArrayBuffer(this.matA.shape[0]*this.matB.shape[1]*4),a=new Uint8Array(r);return this.GL.readPixels(0,0,this.matB.shape[1],this.matA.shape[0],this.GL.RGBA,this.GL.UNSIGNED_BYTE,a),new Float32Array(r)}}]),r}());a.default=o,r.exports=a.default},function(r,a){"use strict";function t(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var e=function(){function r(r,a){for(var t=0;t<a.length;t++){var e=a[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}return function(a,t,e){return t&&r(a.prototype,t),e&&r(a,e),a}}(),s=function(){function r(a){t(this,r),a=a||{},this.ARRAY_TYPE="undefined"!=typeof Float64Array?Float64Array:Array,this.USE_SIMD=this.ARRAY_TYPE===Float64Array&&"SIMD"in this,this.USE_WEBGL=!1,this._layers=[]}return e(r,[{key:"addLayer",value:function(r){this._layers.push(r)}},{key:"predict",value:function(r){}}]),r}();a.NeuralNet=s},function(r,a,t){"use strict";function e(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function s(r){var a=new e;a.pre=r.pre,a.body=r.body,a.post=r.post;var t=r.args.slice(0);a.argTypes=t;for(var s=0;s<t.length;++s){var i=t[s];if("array"===i||"object"==typeof i&&i.blockIndices){if(a.argTypes[s]="array",a.arrayArgs.push(s),a.arrayBlockIndices.push(i.blockIndices?i.blockIndices:0),a.shimArgs.push("array"+s),s<a.pre.args.length&&a.pre.args[s].count>0)throw new Error("cwise: pre() block may not reference array args");if(s<a.post.args.length&&a.post.args[s].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===i)a.scalarArgs.push(s),a.shimArgs.push("scalar"+s);else if("index"===i){if(a.indexArgs.push(s),s<a.pre.args.length&&a.pre.args[s].count>0)throw new Error("cwise: pre() block may not reference array index");if(s<a.body.args.length&&a.body.args[s].lvalue)throw new Error("cwise: body() block may not write to array index");if(s<a.post.args.length&&a.post.args[s].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===i){if(a.shapeArgs.push(s),s<a.pre.args.length&&a.pre.args[s].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(s<a.body.args.length&&a.body.args[s].lvalue)throw new Error("cwise: body() block may not write to array shape");
if(s<a.post.args.length&&a.post.args[s].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof i||!i.offset)throw new Error("cwise: Unknown argument type "+t[s]);a.argTypes[s]="offset",a.offsetArgs.push({array:i.array,offset:i.offset}),a.offsetArgIndex.push(s)}}if(a.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(a.pre.args.length>t.length)throw new Error("cwise: Too many arguments in pre() block");if(a.body.args.length>t.length)throw new Error("cwise: Too many arguments in body() block");if(a.post.args.length>t.length)throw new Error("cwise: Too many arguments in post() block");return a.debug=!!r.printCode||!!r.debug,a.funcName=r.funcName||"cwise",a.blockSize=r.blockSize||64,n(a)}var n=t(13);r.exports=s},function(r,a,t){"use strict";function e(r,a,t){var e,s,n=r.length,i=a.arrayArgs.length,o=a.indexArgs.length>0,u=[],h=[],l=0,f=0;for(e=0;n>e;++e)h.push(["i",e,"=0"].join(""));for(s=0;i>s;++s)for(e=0;n>e;++e)f=l,l=r[e],0===e?h.push(["d",s,"s",e,"=t",s,"p",l].join("")):h.push(["d",s,"s",e,"=(t",s,"p",l,"-s",f,"*t",s,"p",f,")"].join(""));for(u.push("var "+h.join(",")),e=n-1;e>=0;--e)l=r[e],u.push(["for(i",e,"=0;i",e,"<s",l,";++i",e,"){"].join(""));for(u.push(t),e=0;n>e;++e){for(f=l,l=r[e],s=0;i>s;++s)u.push(["p",s,"+=d",s,"s",e].join(""));o&&(e>0&&u.push(["index[",f,"]-=s",f].join("")),u.push(["++index[",l,"]"].join(""))),u.push("}")}return u.join("\n")}function s(r,a,t,s){for(var n=a.length,i=t.arrayArgs.length,o=t.blockSize,u=t.indexArgs.length>0,h=[],l=0;i>l;++l)h.push(["var offset",l,"=p",l].join(""));for(var l=r;n>l;++l)h.push(["for(var j"+l+"=SS[",a[l],"]|0;j",l,">0;){"].join("")),h.push(["if(j",l,"<",o,"){"].join("")),h.push(["s",a[l],"=j",l].join("")),h.push(["j",l,"=0"].join("")),h.push(["}else{s",a[l],"=",o].join("")),h.push(["j",l,"-=",o,"}"].join("")),u&&h.push(["index[",a[l],"]=j",l].join(""));for(var l=0;i>l;++l){for(var f=["offset"+l],c=r;n>c;++c)f.push(["j",c,"*t",l,"p",a[c]].join(""));h.push(["p",l,"=(",f.join("+"),")"].join(""))}h.push(e(a,t,s));for(var l=r;n>l;++l)h.push("}");return h.join("\n")}function n(r){for(var a=0,t=r[0].length;t>a;){for(var e=1;e<r.length;++e)if(r[e][a]!==r[0][a])return a;++a}return a}function i(r,a,t){for(var e=r.body,s=[],n=[],i=0;i<r.args.length;++i){var o=r.args[i];if(!(o.count<=0)){var u=new RegExp(o.name,"g"),h="",l=a.arrayArgs.indexOf(i);switch(a.argTypes[i]){case"offset":var f=a.offsetArgIndex.indexOf(i),c=a.offsetArgs[f];l=c.array,h="+q"+f;case"array":h="p"+l+h;var d="l"+i,p="a"+l;if(0===a.arrayBlockIndices[l])1===o.count?"generic"===t[l]?o.lvalue?(s.push(["var ",d,"=",p,".get(",h,")"].join("")),e=e.replace(u,d),n.push([p,".set(",h,",",d,")"].join(""))):e=e.replace(u,[p,".get(",h,")"].join("")):e=e.replace(u,[p,"[",h,"]"].join("")):"generic"===t[l]?(s.push(["var ",d,"=",p,".get(",h,")"].join("")),e=e.replace(u,d),o.lvalue&&n.push([p,".set(",h,",",d,")"].join(""))):(s.push(["var ",d,"=",p,"[",h,"]"].join("")),e=e.replace(u,d),o.lvalue&&n.push([p,"[",h,"]=",d].join("")));else{for(var _=[o.name],g=[h],y=0;y<Math.abs(a.arrayBlockIndices[l]);y++)_.push("\\s*\\[([^\\]]+)\\]"),g.push("$"+(y+1)+"*t"+l+"b"+y);if(u=new RegExp(_.join(""),"g"),h=g.join("+"),"generic"===t[l])throw new Error("cwise: Generic arrays not supported in combination with blocks!");e=e.replace(u,[p,"[",h,"]"].join(""))}break;case"scalar":e=e.replace(u,"Y"+a.scalarArgs.indexOf(i));break;case"index":e=e.replace(u,"index");break;case"shape":e=e.replace(u,"shape")}}}return[s.join("\n"),e,n.join("\n")].join("\n").trim()}function o(r){for(var a=new Array(r.length),t=!0,e=0;e<r.length;++e){var s=r[e],n=s.match(/\d+/);n=n?n[0]:"",0===s.charAt(0)?a[e]="u"+s.charAt(1)+n:a[e]=s.charAt(0)+n,e>0&&(t=t&&a[e]===a[e-1])}return t?a[0]:a.join("")}function u(r,a){for(var t=a[1].length-Math.abs(r.arrayBlockIndices[0])|0,u=new Array(r.arrayArgs.length),l=new Array(r.arrayArgs.length),f=0;f<r.arrayArgs.length;++f)l[f]=a[2*f],u[f]=a[2*f+1];for(var c=[],d=[],p=[],_=[],g=[],f=0;f<r.arrayArgs.length;++f){r.arrayBlockIndices[f]<0?(p.push(0),_.push(t),c.push(t),d.push(t+r.arrayBlockIndices[f])):(p.push(r.arrayBlockIndices[f]),_.push(r.arrayBlockIndices[f]+t),c.push(0),d.push(r.arrayBlockIndices[f]));for(var y=[],m=0;m<u[f].length;m++)p[f]<=u[f][m]&&u[f][m]<_[f]&&y.push(u[f][m]-p[f]);g.push(y)}for(var v=["SS"],b=["'use strict'"],A=[],m=0;t>m;++m)A.push(["s",m,"=SS[",m,"]"].join(""));for(var f=0;f<r.arrayArgs.length;++f){v.push("a"+f),v.push("t"+f),v.push("p"+f);for(var m=0;t>m;++m)A.push(["t",f,"p",m,"=t",f,"[",p[f]+m,"]"].join(""));for(var m=0;m<Math.abs(r.arrayBlockIndices[f]);++m)A.push(["t",f,"b",m,"=t",f,"[",c[f]+m,"]"].join(""))}for(var f=0;f<r.scalarArgs.length;++f)v.push("Y"+f);if(r.shapeArgs.length>0&&A.push("shape=SS.slice(0)"),r.indexArgs.length>0){for(var w=new Array(t),f=0;t>f;++f)w[f]="0";A.push(["index=[",w.join(","),"]"].join(""))}for(var f=0;f<r.offsetArgs.length;++f){for(var L=r.offsetArgs[f],j=[],m=0;m<L.offset.length;++m)0!==L.offset[m]&&(1===L.offset[m]?j.push(["t",L.array,"p",m].join("")):j.push([L.offset[m],"*t",L.array,"p",m].join("")));0===j.length?A.push("q"+f+"=0"):A.push(["q",f,"=",j.join("+")].join(""))}var x=h([].concat(r.pre.thisVars).concat(r.body.thisVars).concat(r.post.thisVars));A=A.concat(x),b.push("var "+A.join(","));for(var f=0;f<r.arrayArgs.length;++f)b.push("p"+f+"|=0");r.pre.body.length>3&&b.push(i(r.pre,r,l));var G=i(r.body,r,l),E=n(g);t>E?b.push(s(E,g[0],r,G)):b.push(e(g[0],r,G)),r.post.body.length>3&&b.push(i(r.post,r,l)),r.debug&&console.log("-----Generated cwise routine for ",a,":\n"+b.join("\n")+"\n----------");var V=[r.funcName||"unnamed","_cwise_loop_",u[0].join("s"),"m",E,o(l)].join(""),T=new Function(["function ",V,"(",v.join(","),"){",b.join("\n"),"} return ",V].join(""));return T()}var h=t(14);r.exports=u},function(r,a,t){"use strict";function e(r){var a=["'use strict'","var CACHED={}"],t=[],e=r.funcName+"_cwise_thunk";a.push(["return function ",e,"(",r.shimArgs.join(","),"){"].join(""));for(var n=[],i=[],o=[["array",r.arrayArgs[0],".shape.slice(",Math.max(0,r.arrayBlockIndices[0]),r.arrayBlockIndices[0]<0?","+r.arrayBlockIndices[0]+")":")"].join("")],u=[],h=[],l=0;l<r.arrayArgs.length;++l){var f=r.arrayArgs[l];t.push(["t",f,"=array",f,".dtype,","r",f,"=array",f,".order"].join("")),n.push("t"+f),n.push("r"+f),i.push("t"+f),i.push("r"+f+".join()"),o.push("array"+f+".data"),o.push("array"+f+".stride"),o.push("array"+f+".offset|0"),l>0&&(u.push("array"+r.arrayArgs[0]+".shape.length===array"+f+".shape.length+"+(Math.abs(r.arrayBlockIndices[0])-Math.abs(r.arrayBlockIndices[l]))),h.push("array"+r.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,r.arrayBlockIndices[0])+"]===array"+f+".shape[shapeIndex+"+Math.max(0,r.arrayBlockIndices[l])+"]"))}r.arrayArgs.length>1&&(a.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),a.push("for(var shapeIndex=array"+r.arrayArgs[0]+".shape.length-"+Math.abs(r.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),a.push("if (!("+h.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),a.push("}"));for(var l=0;l<r.scalarArgs.length;++l)o.push("scalar"+r.scalarArgs[l]);t.push(["type=[",i.join(","),"].join()"].join("")),t.push("proc=CACHED[type]"),a.push("var "+t.join(",")),a.push(["if(!proc){","CACHED[type]=proc=compile([",n.join(","),"])}","return proc(",o.join(","),")}"].join("")),r.debug&&console.log("-----Generated thunk:\n"+a.join("\n")+"\n----------");var c=new Function("compile",a.join("\n"));return c(s.bind(void 0,r))}var s=t(12);r.exports=e},function(r,a){"use strict";function t(r,a){for(var t=1,e=r.length,s=r[0],n=r[0],i=1;e>i;++i)if(n=s,s=r[i],a(s,n)){if(i===t){t++;continue}r[t++]=s}return r.length=t,r}function e(r){for(var a=1,t=r.length,e=r[0],s=r[0],n=1;t>n;++n,s=e)if(s=e,e=r[n],e!==s){if(n===a){a++;continue}r[a++]=e}return r.length=a,r}function s(r,a,s){return 0===r.length?r:a?(s||r.sort(a),t(r,a)):(s||r.sort(),e(r))}r.exports=s},function(r,a){"use strict";function t(r){for(var a=new Array(r),t=0;r>t;++t)a[t]=t;return a}r.exports=t},function(r,a){r.exports=function(r){return!(null==r||!(r._isBuffer||r.constructor&&"function"==typeof r.constructor.isBuffer&&r.constructor.isBuffer(r)))}}]);